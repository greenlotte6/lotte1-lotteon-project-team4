<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Gothic+A1&family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Nanum+Gothic&display=swap"
          rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/common/_admin_header.css}">
    <link rel="stylesheet" th:href="@{/css/common/_admin_footer.css}">
    <link rel="stylesheet" th:href="@{/css/admin/config/version.css}">
    <!-- js -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Font Awesome CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <title>admin basic</title>
</head>
<script src="/js/modal.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function () {

        $('.hover').click(function (e) {
            $(this).parent().toggleClass('active');
        })

        // 모달 열기 함수
        function openModal(className) {
            document.querySelector(`.${className}`).style.display = 'flex';
        }

        // 모달 닫기 함수
        window.closeModal = function () {
            document.querySelectorAll('.modal-overlay').forEach(modal => {
                modal.style.display = 'none';
            });
        };

        //등록 버튼 클릭 시 등록 모달 열기
        document.querySelector(".banner-register").addEventListener('click', () => {
            openModal('register-modal');
        });

        document.querySelectorAll("table tr td:last-child").forEach(td => {
            td.style.cursor = 'pointer';
            td.addEventListener('click', (event) => {
                const row = event.target.closest('tr');
                const versionId = row.children[2]?.textContent.trim() || '';
                const changeHistory = row.children[5]?.textContent.trim() || '';

                console.log('버전 ID:', versionId);
                console.log('변경내역:', changeHistory);

                // 모달에 데이터 넣기
                document.getElementById('modalversionid').innerText = versionId;
                document.getElementById('modalchangehistory').innerText = changeHistory;


                openModal('info-modal'); // 모달 열기
            });
        });

    });
</script>
<body>
<th:block th:include="/common/_admin_header"/>
<main>
    <div class="main-wrapper">
        <th:block th:include="/common/_admin_aside"/>

        <div class="main">
            <div class="setting">
                <h1>버전관리</h1>
                <ul>
                    <li><a th:href="@{/admin/index}">HOME &nbsp;>&nbsp;</a></li>
                    <li><a th:href="@{/admin/config/basic}">환경설정 &nbsp;>&nbsp;</a></li>
                    <li><a th:href="@{/admin/config/version}"><span>버전관리 &nbsp;</span></a></li>
                </ul>
            </div>
            <div class="line"></div>
            <div class="container">
                <div class="version-list">
                    <h2>버전 목록</h2>
                    <div class="version-list-text p-div">
                        <p>사이트 버전 목록입니다.</p>
                    </div>
                </div>
                <div class="table">
                    <table>
                        <thead>
                        <tr>
                            <th><input type="checkbox"></th>
                            <th>번호</th>
                            <th>버전</th>
                            <th>작성자</th>
                            <th>등록일시</th>
                            <th>변경내역</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:each="ver : ${versions}">
                            <td><input type="checkbox" name="selectedIds" th:value="${ver.versionId}"></td>
                            <td th:text="${ver.versionId}">1</td>
                            <td th:text="${ver.versionName}">버전명</td>
                            <td th:text="${ver.user.uid}"></td>
                            <td th:text="${#temporals.format(ver.rdate, 'yyyy-MM-dd HH:mm:ss')}">등록일</td>
                            <td th:text="${ver.changeHistory}" style="display: none"></td>
                            <td>
                                <button class="btn">[확인]</button>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
                <div class="click">
                    <button class="select-delete button">선택삭제</button>
                    <button class="banner-register button btn">버전등록</button>
                </div>

            </div>
        </div>
    </div>
</main>

<div class="modal-overlay register-modal">
    <div class="modal">
        <div class="modal-header">
            <div class="modal-title"><span>■</span>버전등록</div>
            <button class="modal-button" onclick="closeModal()">X</button>
        </div>

        <div class="modal-table">
            <table>
                <tr>
                    <td class="label">버전</td>
                    <td><input type="text" class="text" placeholder="버전입력하기"></td>
                </tr>
                <tr>
                    <td class="label">변경내역</td>
                    <td><textarea placeholder="변경내역 작성하기"></textarea></td>
                    </td>
                </tr>
            </table>
        </div>
        <div class="modal-footer">
            <button type="button" class="submit-btn" onclick="submitCoupon()">등록</button>
        </div>
    </div>
</div>

<div class="modal-overlay info-modal">
    <div class="modal">
        <div class="modal-header">
            <div class="modal-title"><span>■</span>버전확인</div>
            <button class="modal-button" onclick="closeModal()">X</button>
        </div>


        <table class="info-table">
            <tr>
                <td class="label">버전</td>
                <td id="modalversionid"></td>
            </tr>
            <tr>
                <td class="label">변경내역</td>
                <td id="modalchangehistory"></td>
            </tr>
        </table>

        <div class="modal-footer">
            <button onclick="closeModal()">닫기</button>
        </div>
    </div>
</div>
<th:block th:include="/common/_admin_footer"/>
</body>
</html>